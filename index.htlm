<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<title>Millionaire Power — V2 layout (clean)</title>
<style>
:root{
  --bg:#0f1321;--panel:#161a2a;--muted:#8ea3c0;--text:#eaf0ff;
  --accent:#5f7dff;--good:#2ecc71;--bad:#ff5c5c;--gold:#ffd166;
  --chip:#1d2238;--chipOn:#2a3150
}
*{box-sizing:border-box}
body{margin:0;background:linear-gradient(180deg,#0f1321,#0b1120);color:var(--text);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;}
.wrap{max-width:1200px;margin:0 auto;padding:20px}
.top{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
h1{font-size:20px;margin:0 10px 0 0}
.btn{background:var(--chip);border:1px solid rgba(255,255,255,.08);color:var(--text);
  padding:10px 12px;border-radius:10px;cursor:pointer}
.btn:active{transform:scale(.98)}
/* Layout: Top dashboard, bottom area split left/right */
.gridTop{display:grid;grid-template-columns:1fr;gap:14px;margin-top:14px}
.gridBottom{display:grid;grid-template-columns:1.2fr 1fr;gap:14px;margin-top:14px}
.card{background:var(--panel);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:14px;box-shadow: 0 8px 20px rgba(0,0,0,.2)}
.kpis{display:grid;grid-template-columns:repeat(5,1fr);gap:8px}
.kpis .k{background:var(--chip);padding:10px;border-radius:12px;text-align:center}
.k .v{font-weight:700;font-size:18px}
.progress{height:10px;background:#1c2240;border:1px solid rgba(255,255,255,.08);border-radius:10px;overflow:hidden;margin-top:6px}
.progress>span{display:block;height:100%;background:linear-gradient(90deg,#5f7dff,#ffd166);width:0%}
.small{font-size:12px;color:var(--muted)}
/* Room */
.room{position:relative; height:380px; overflow:hidden}
.stage{position:absolute; inset:14px; background:#0e1426; border:1px solid rgba(255,255,255,.07); border-radius:12px}
.floor{position:absolute; left:0; right:0; bottom:0; height:70px; background:linear-gradient(180deg,#151a2d,#0b0f1f);}
.bench{position:absolute; left:90px; bottom:80px; width:260px; height:70px; background:#1b2136; border-radius:8px}
.bar{position:absolute; left:85px; bottom:150px; width:270px; height:16px;background:#2a314d;border-radius:8px}
.whiteboard{position:absolute; left:330px; top:60px; width:230px; height:140px; background:#f4f7ff; color:#233; border-radius:10px; padding:10px; box-shadow:0 8px 16px rgba(0,0,0,.35)}
.whiteboard h4{margin:0 0 6px 0}
.bottles{position:absolute; left:310px; bottom:88px; display:flex; gap:6px}
.bottle{width:18px;height:44px;border-radius:4px;background:rgba(160,210,255,.15);border:2px solid rgba(160,210,255,.4); position:relative;overflow:hidden}
.bottle.fill::after{content:''; position:absolute; left:0; right:0; bottom:0; height:70%; background:rgba(120,185,255,.9)}
.pulbar{position:absolute; left:20px; top:20px; width:120px; height:290px; border-left:6px solid #1f2742; border-right:6px solid #1f2742; border-top:10px solid #1f2742; border-radius:8px}
.avatar{position:absolute; right:40px; bottom:70px; width:180px; height:250px}
svg{width:100%;height:100%}
.armR{transform-origin: 120px 120px; transition: transform .25s ease}
.can, .cup, .phone, .smoke{opacity:0; transition:opacity .15s ease}
.glow{filter: drop-shadow(0 0 6px #ffb347)}
/* Controls / objectifs du jour */
.controls .row{display:flex; align-items:center; justify-content:space-between; padding:8px 0; border-bottom:1px dashed rgba(255,255,255,.06)}
.controls .left{display:flex; align-items:center; gap:8px; font-weight:600}
.counter{display:flex; align-items:center; gap:8px}
.counter .n{width:40px; text-align:center}
.counter button{width:34px;height:34px;border-radius:10px;border:1px solid rgba(255,255,255,.1);background:#1c2240;color:var(--text);cursor:pointer}
.helpIcon{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border-radius:50%;border:1px solid rgba(255,255,255,.25);font-size:12px;opacity:.8;cursor:help}
.helpIcon:hover{opacity:1}
.tags{display:flex; gap:6px; flex-wrap:wrap; margin-top:6px}
.tag{background:var(--chip); border:1px solid rgba(255,255,255,.08); padding:5px 8px; border-radius:10px}
.footer{display:flex; gap:10px; flex-wrap:wrap; align-items:center;margin-top:10px}
</style>
</head>
<body>
<div class="wrap">
  <div class="top">
    <h1>Millionaire Power — V2 (layout fidèle)</h1>
    <div id="dayBadge" class="btn">📅 Day 1</div>
    <button class="btn" id="btnFinish">🏁 Finir la journée</button>
    <button class="btn" id="btnReport">📄 Rapport NB-LEL</button>
    <button class="btn" id="btnReset">🔁 Reset</button>
  </div>

  <!-- TOP: DASHBOARD (annuel + points seulement) -->
  <div class="gridTop">
    <div class="card">
      <div class="kpis" id="kpis"></div>
      <div class="small">Objectif annuel: <b>1,000,000 points</b>
        <div class="progress"><span id="progBar"></span></div>
        <div class="small" id="progTxt"></div>
      </div>
    </div>
  </div>

  <!-- BOTTOM: LEFT = ROOM (avatar/animations), RIGHT = OBJECTIFS DU JOUR -->
  <div class="gridBottom">
    <div class="card room" id="room">
      <div class="stage" aria-label="Chambre de Gabriel">
        <div class="pulbar"></div>
        <div class="bar"></div>
        <div class="bench"></div>
        <div class="whiteboard">
          <h4>QUOTE</h4>
          <div id="quoteTxt">Build the man before the empire.</div>
        </div>
        <div class="bottles" id="bottles"></div>
        <div class="avatar" id="avatar">
          <svg viewBox="0 0 180 250">
            <rect x="65" y="170" width="20" height="70" rx="10" fill="#4a66b8"/>
            <rect x="95" y="170" width="20" height="70" rx="10" fill="#4a66b8"/>
            <rect x="50" y="100" width="80" height="80" rx="16" fill="#5c7ce0"/>
            <circle cx="80" cy="140" r="12" fill="#c0545b"/>
            <circle cx="100" cy="140" r="12" fill="#c0545b"/>
            <rect x="32" y="120" width="16" height="50" rx="8" fill="#5c7ce0"/>
            <g class="armR" id="armR"><rect x="132" y="120" width="16" height="50" rx="8" fill="#5c7ce0"/></g>
            <circle cx="90" cy="80" r="26" fill="#f0c69a"/>
            <rect x="60" y="60" width="60" height="18" rx="9" fill="#8d5e3a"/>
            <rect x="64" y="68" width="22" height="8" rx="3" fill="#0b0f1f"/>
            <rect x="94" y="68" width="22" height="8" rx="3" fill="#0b0f1f"/>
            <path d="M78,90 Q90,100 102,90" stroke="#0b0f1f" stroke-width="4" fill="none"/>
            <text x="84" y="58" text-anchor="middle" font-size="10" fill="#d7b48a">LA</text>
            <rect id="can" class="can" x="130" y="135" width="14" height="24" rx="3" fill="#9ed0ff" stroke="#c8e6ff"/>
            <rect id="cup" class="cup" x="130" y="135" width="18" height="22" rx="3" fill="#b3d7ff" stroke="#eaf3ff"/>
            <rect id="phone" class="phone" x="126" y="130" width="22" height="34" rx="4" fill="#222"/>
            <g id="smoke" class="smoke">
              <circle cx="60" cy="116" r="3" fill="#cbd2e9" opacity=".8"/>
              <circle cx="54" cy="108" r="2" fill="#cbd2e9" opacity=".6"/>
              <circle cx="50" cy="100" r="1.6" fill="#cbd2e9" opacity=".4"/>
            </g>
          </svg>
        </div>
        <div class="floor"></div>
      </div>
    </div>

    <div class="card controls">
      <h3>Objectifs du jour</h3>
      <div class="row"><div class="left">💧 Eau (12×250 ml) <span class="helpIcon" title="Hydratation = énergie, focus, récupération. Objectif: 8–12 verres.">?</span></div>
        <div class="counter"><button data-ctl="eau" data-d="-1">−</button><div class="n" id="n_eau">0</div><button data-ctl="eau" data-d="1">+</button></div>
      </div>
      <div class="row"><div class="left">😴 Sommeil (h) <span class="helpIcon" title="7–9 h = mémoire, hormones, performance, humeur.">?</span></div>
        <div class="counter"><button data-ctl="sleep" data-d="-1">−</button><div class="n" id="n_sleep">0</div><button data-ctl="sleep" data-d="1">+</button></div>
      </div>
      <div class="tags"><label class="tag"><input id="lever5" type="checkbox"> Lever 5h</label><label class="tag"><input id="coucher21" type="checkbox"> Coucher 21h</label></div>

      <div class="row"><div class="left">📚 Étude (h) <span class="helpIcon" title="Apprendre = augmenter ta valeur. Vise 1–3 h/jour.">?</span></div>
        <div class="counter"><button data-ctl="study" data-d="-1">−</button><div class="n" id="n_study">0</div><button data-ctl="study" data-d="1">+</button></div>
      </div>

      <div class="row"><div class="left">💪 Pull-up <span class="helpIcon" title="Tractions = dos/bras, posture, discipline.">?</span></div>
        <div class="counter"><button id="btnPull">+1</button></div>
      </div>

      <div class="row"><div class="left">🚬 Nicotine <span class="helpIcon" title="Réduire = meilleure santé + économies.">?</span></div>
        <div class="counter"><button data-ctl="nic" data-d="-1">−</button><div class="n" id="n_nic">0</div><button data-ctl="nic" data-d="1">+</button></div>
      </div>
      <div class="row"><div class="left">🌿 Weed</div>
        <div class="counter"><button data-ctl="weed" data-d="-1">−</button><div class="n" id="n_weed">0</div><button data-ctl="weed" data-d="1">+</button></div>
      </div>
      <div class="row"><div class="left">🍺 Alcool</div>
        <div class="counter"><button data-ctl="alc" data-d="-1">−</button><div class="n" id="n_alc">0</div><button data-ctl="alc" data-d="1">+</button></div>
      </div>
      <div class="row"><div class="left">📱 Porn</div>
        <div class="counter"><button data-ctl="porn" data-d="-1">−</button><div class="n" id="n_porn">0</div><button data-ctl="porn" data-d="1">+</button></div>
      </div>

      <div class="row"><div class="left">🤝 Honnêteté</div>
        <div><button class="btn" id="bHon">+1 honnête</button> <button class="btn" id="bFaux">+1 faux</button></div>
      </div>
      <div class="row"><div class="left">🙏 Prière</div><button class="btn" id="bPray">Basculer</button></div>
      <div class="row"><div class="left">📝 Réflexion fin de journée</div><button class="btn" id="bReflect">Basculer</button></div>

      <div class="row"><div class="left">🪥 Brossage dents</div><button class="btn" id="bDents">Basculer</button></div>
      <div class="row"><div class="left">🛏️ Nettoyer chambre</div><button class="btn" id="bChambre">Basculer</button></div>
      <div class="row"><div class="left">🚗 Nettoyer voiture</div><button class="btn" id="bVoiture">Basculer</button></div>
      <div class="row"><div class="left">🛁 Nettoyer salle de bain</div><button class="btn" id="bSalleBain">Basculer</button></div>
    </div>
  </div>

  <div class="footer small" id="saveInfo">Auto-sauvegarde locale activée.</div>
</div>

<!-- Report modal -->
<div class="modal" id="modal" style="display:none;place-items:center;position:fixed;inset:0;background:rgba(0,0,0,.55)">
  <div class="card" style="width:clamp(280px,80vw,820px);">
    <button class="btn" id="closeM" style="float:right">Fermer</button>
    <h3>Rapport NB-LEL</h3>
    <div class="tags">
      <button class="btn" data-rpt="day">Jour</button>
      <button class="btn" data-rpt="week">Semaine</button>
      <button class="btn" data-rpt="month">Mois</button>
      <button class="btn" data-rpt="year">Année</button>
      <button class="btn" id="btnPDF">📥 Télécharger PDF</button>
    </div>
    <pre id="report" style="white-space:pre-wrap"></pre>
  </div>
</div>

<script>
// ---------- State ----------
const state = JSON.parse(localStorage.getItem('mp_state_v2_layout')||'{}');
const todayISO = new Date().toISOString().slice(0,10);
const data = Object.assign({
  // objectifs du jour
  eau:0, sleep:0, study:0, nic:0, weed:0, alc:0, porn:0,
  lever5:false, coucher21:false, honnete:0, faux:0, prie:false, reflex:false,
  pull:0, dents:false, chambre:false, voiture:false, salleBain:false,
  // progression annuelle
  xp:0, day:1, history:[], date: todayISO
}, state.date===todayISO?state:{});

function save(){ localStorage.setItem('mp_state_v2_layout', JSON.stringify(data)); document.getElementById('saveInfo').textContent='Sauvé '+new Date().toLocaleTimeString(); }
function el(id){return document.getElementById(id)}
function clamp(v,min,max){return Math.max(min, Math.min(max, v))}

// ---------- Sounds ----------
const audioCtx = new (window.AudioContext||window.webkitAudioContext)();
function beep(freq=880, dur=0.08, type='sine', gain=0.06){
  const o=audioCtx.createOscillator(), g=audioCtx.createGain();
  o.type=type; o.frequency.value=freq;
  g.gain.value=gain;
  o.connect(g); g.connect(audioCtx.destination);
  o.start();
  setTimeout(()=>{o.stop()}, dur*1000);
}
function okFx(){ beep(880,0.07,'square',0.06); setTimeout(()=>beep(1320,0.06,'square',0.05),60) }
function badFx(){ beep(200,0.09,'sawtooth',0.07) }
function clickFx(){ beep(520,0.04,'triangle',0.04) }

// ---------- Calcul points ----------
function pointsJour(){
  const sleepBonus = (data.sleep>=7 && data.sleep<=9)?12:0;
  const studyPts = Math.min(6, data.study)*3;
  const eauPts = data.eau*2;
  const pullPts = Math.min(20, data.pull)*1;
  const habits = (data.lever5?5:0) + (data.coucher21?5:0) + (data.prie?2:0) + (data.reflex?2:0);
  const integrity = data.honnete*1 - data.faux*2;
  const chores = (data.dents?2:0) + (data.chambre?3:0) + (data.voiture?3:0) + (data.salleBain?3:0);
  const penalties = data.nic*3 + data.weed*3 + data.alc*2 + data.porn*1;
  const raw = eauPts + sleepBonus + studyPts + pullPts + habits + integrity + chores - penalties;
  return Math.max(0, Math.round(raw));
}

function score(){
  const points = pointsJour();
  const power = Math.max(-100, Math.min(100, points - (data.nic*4 + data.weed*3 + data.alc*3 + data.porn*2)));
  return {points, power};
}

// ---------- UI (Dashboard) ----------
function chip(title,val){ return `<div class="k"><div class="v">${val}</div><div class="t small">${title}</div></div>`}
function updDashboard(){
  const s=score();
  el('kpis').innerHTML = 
    chip('🎯 Points du jour', s.points) +
    chip('XP cumulée', data.xp) +
    chip('Power', s.power) +
    chip('Objectif annuel', '1,000,000') +
    chip('Jour', 'Day '+data.day);
  const pct = Math.min(100, (data.xp/1000000)*100);
  el('progBar').style.width = pct.toFixed(2)+'%';
  el('progTxt').textContent = `${data.xp.toLocaleString()} / 1,000,000 points — ${pct.toFixed(2)}%`;
  el('dayBadge').textContent='📅 Day '+data.day;
}

// ---------- Chambre (animations + bouteilles) ----------
function drawBottles(){
  const b=el('bottles'); b.innerHTML='';
  for(let i=0;i<12;i++){const d=document.createElement('div'); d.className='bottle'+(i<data.eau?' fill':''); b.appendChild(d)}
}

function anim(type){
  const arm = el('armR'); const cup=el('cup'), can=el('can'), phone=el('phone'), smoke=el('smoke');
  cup.style.opacity=0; can.style.opacity=0; phone.style.opacity=0; smoke.style.opacity=0;
  if(type==='water'){cup.style.opacity=1; arm.style.transform='rotate(-35deg)'; setTimeout(()=>{arm.style.transform='rotate(0deg)';cup.style.opacity=0;},700)}
  if(type==='alc'){can.style.opacity=1; arm.style.transform='rotate(-35deg)'; setTimeout(()=>{arm.style.transform='rotate(0deg)';can.style.opacity=0;},800)}
  if(type==='porn'){phone.style.opacity=1; phone.classList.add('glow'); setTimeout(()=>phone.classList.remove('glow'),400); setTimeout(()=>{phone.style.opacity=0},900)}
  if(type==='smoke'){smoke.style.opacity=1; setTimeout(()=>{smoke.style.opacity=0},900)}
  if(type==='pull'){ const av=document.getElementById('avatar'); av.style.transition='transform .35s ease'; av.style.transform='translateY(-40px)'; setTimeout(()=>{av.style.transform='translateY(0)'},350); }
}

// ---------- Objectifs du jour (compteurs) ----------
function updCounters(){
  el('n_eau').textContent=data.eau;
  el('n_sleep').textContent=data.sleep;
  el('n_study').textContent=data.study;
  el('n_nic').textContent=data.nic;
  el('n_weed').textContent=data.weed;
  el('n_alc').textContent=data.alc;
  el('n_porn').textContent=data.porn;
  document.getElementById('lever5').checked=data.lever5;
  document.getElementById('coucher21').checked=data.coucher21;
  drawBottles(); updDashboard(); save();
}

document.querySelectorAll('button[data-ctl]').forEach(b=>{
  b.addEventListener('click', e=>{
    const k=b.dataset.ctl, d=parseInt(b.dataset.d||'0',10);
    if(k==='eau'){ data.eau=clamp(data.eau+d,0,12); anim('water'); (d>0?okFx():clickFx()); }
    if(k==='sleep'){ data.sleep=clamp(data.sleep+d,0,24); clickFx(); }
    if(k==='study'){ data.study=clamp(data.study+d,0,24); okFx(); }
    if(k==='nic'){ data.nic=Math.max(0,data.nic+d); (d>0?badFx():clickFx()); anim('smoke'); }
    if(k==='weed'){ data.weed=Math.max(0,data.weed+d); (d>0?badFx():clickFx()); anim('smoke'); }
    if(k==='alc'){ data.alc=Math.max(0,data.alc+d); (d>0?badFx():clickFx()); anim('alc'); }
    if(k==='porn'){ data.porn=Math.max(0,data.porn+d); (d>0?badFx():clickFx()); anim('porn'); }
    updCounters();
  })
})

document.getElementById('lever5').addEventListener('change',e=>{data.lever5=e.target.checked; okFx(); updCounters()})
document.getElementById('coucher21').addEventListener('change',e=>{data.coucher21=e.target.checked; okFx(); updCounters()})
document.getElementById('btnPull').addEventListener('click',()=>{data.pull++; okFx(); anim('pull'); updCounters()})
document.getElementById('bHon').addEventListener('click',()=>{data.honnete++; okFx(); save()})
document.getElementById('bFaux').addEventListener('click',()=>{data.faux++; badFx(); save()})
document.getElementById('bPray').addEventListener('click',()=>{data.prie=!data.prie; okFx(); save()})
document.getElementById('bReflect').addEventListener('click',()=>{data.reflex=!data.reflex; okFx(); save()})
document.getElementById('bDents').addEventListener('click',()=>{data.dents=!data.dents; okFx(); save()})
document.getElementById('bChambre').addEventListener('click',()=>{data.chambre=!data.chambre; okFx(); save()})
document.getElementById('bVoiture').addEventListener('click',()=>{data.voiture=!data.voiture; okFx(); save()})
document.getElementById('bSalleBain').addEventListener('click',()=>{data.salleBain=!data.salleBain; okFx(); save()})

// ---------- Rapport NB-LEL + PDF ----------
function snapshot(){
  const s=score();
  return {date:data.date, day:data.day, points:s.points, power:s.power,
    eau:data.eau, sleep:data.sleep, study:data.study, nic:data.nic, weed:data.weed, alc:data.alc, porn:data.porn,
    lever5:data.lever5, coucher21:data.coucher21, honnete:data.honnete, faux:data.faux, prie:data.prie, reflex:data.reflex,
    dents:data.dents, chambre:data.chambre, voiture:data.voiture, salleBain:data.salleBain};
}
function rangeFilter(days){
  const now = new Date(data.date);
  const start = new Date(now); start.setDate(start.getDate()-(days-1));
  const sISO = start.toISOString().slice(0,10);
  return data.history.filter(h=>h.date>=sISO && h.date<=data.date);
}
function sum(arr,key){return arr.reduce((a,x)=>a+(+x[key]||0),0)}
function avg(arr,key){return arr.length?sum(arr,key)/arr.length:0}
function nblelText(arr,title){
  const pts=sum(arr,'points'); const pwr=Math.round(avg(arr,'power'));
  return `NB-LEL — ${title}
Période: ${arr.length?arr[0].date+' → '+arr[arr.length-1].date:data.date} | Jours analysés: ${arr.length||1}

Mon verdict: tu avances. Points récoltés: ${pts}. Power moyen: ${pwr}. 
Objectif: protéger ton sommeil, boire ton eau et gagner des points avant 21h.`;
}
function buildReport(type='day'){
  let arr=[]; let title='';
  if(type==='day'){ arr=[snapshot()]; title='Rapport du jour'; }
  if(type==='week'){ arr=rangeFilter(7); if(arr.length===0) arr=[snapshot()]; title='Rapport de la semaine'; }
  if(type==='month'){ arr=rangeFilter(30); if(arr.length===0) arr=[snapshot()]; title='Rapport du mois'; }
  if(type==='year'){ arr=rangeFilter(365); if(arr.length===0) arr=[snapshot()]; title="Rapport de l'année"; }
  return nblelText(arr,title);
}
let currentReportType='day';
document.getElementById('btnReport').addEventListener('click',()=>{
  currentReportType='day';
  el('report').textContent=buildReport('day');
  el('modal').style.display='grid';
})
document.querySelectorAll('[data-rpt]').forEach(b=>{
  b.addEventListener('click',()=>{
    const t=b.getAttribute('data-rpt'); currentReportType=t;
    el('report').textContent=buildReport(t);
  })
})
document.getElementById('btnPDF').addEventListener('click',()=>{
  const w=window.open('','_blank'); const text=el('report').textContent;
  const html=`<!DOCTYPE html><html><head><meta charset="utf-8"><title>Rapport NB-LEL</title>
  <style>body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;margin:30px;color:#111}
  h1{font-size:20px;margin:0 0 10px} pre{white-space:pre-wrap;font-size:14px;line-height:1.4}
  .muted{color:#666;font-size:12px;margin-top:10px}</style></head><body>
  <h1>Millionaire Power — ${currentReportType.toUpperCase()}</h1>
  <pre>${text.replace(/</g,'&lt;')}</pre>
  <div class="muted">Généré par NB-LEL — ${new Date().toLocaleString()}</div>
  <script>window.print()</script></body></html>`;
  w.document.write(html); w.document.close();
})
document.getElementById('closeM').onclick=()=>el('modal').style.display='none';

// ---------- Finir la journée ----------
document.getElementById('btnFinish').addEventListener('click',()=>{
  const s=score(); data.history.push({date:data.date, day:data.day, points:s.points, power:s.power,
    eau:data.eau, sleep:data.sleep, study:data.study, nic:data.nic, weed:data.weed, alc:data.alc, porn:data.porn,
    lever5:data.lever5, coucher21:data.coucher21, honnete:data.honnete, faux:data.faux, prie:data.prie, reflex:data.reflex,
    dents:data.dents, chambre:data.chambre, voiture:data.voiture, salleBain:data.salleBain});
  data.xp += s.points; data.day += 1;
  Object.assign(data,{eau:0,sleep:0,study:0,nic:0,weed:0,alc:0,porn:0,lever5:false,coucher21:false, honnete:0,faux:0,prie:false,reflex:false,pull:0,dents:false,chambre:false,voiture:false,salleBain:false});
  data.date = new Date(new Date(data.date).getTime()+86400000).toISOString().slice(0,10);
  okFx(); okFx(); updDashboard(); drawBottles(); save();
})

// ---------- Init ----------
function init(){
  // counters display
  el('n_eau').textContent=data.eau; el('n_sleep').textContent=data.sleep; el('n_study').textContent=data.study;
  el('n_nic').textContent=data.nic; el('n_weed').textContent=data.weed; el('n_alc').textContent=data.alc; el('n_porn').textContent=data.porn;
  document.getElementById('lever5').checked=data.lever5; document.getElementById('coucher21').checked=data.coucher21;
  drawBottles(); updDashboard(); save();
}
init();
</script>
</body>
</html>
